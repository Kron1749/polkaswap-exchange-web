"use strict";(self.webpackChunkpolkaswap_exchange_web=self.webpackChunkpolkaswap_exchange_web||[]).push([[6769],{66769:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var s=a(23166),o=a(70655),r=a(36930),l=a(22620),i=a(89445),n=a(33138),c=a(68282),d=a(46697),p=a(89971),u=a(19316),m=a(69781),b=a(50961);const g=(e,t)=>[e,t].join(";");let h=class extends((0,i.Wr)(p.Z,n.Z)){constructor(...e){super(...e),(0,s.Z)(this,"property","apr"),(0,s.Z)(this,"poolsData",{})}async updatePoolsData(){await this.updateExploreData()}get list(){return Object.values(this.pools).map((e=>Object.values(e))).flat(2).filter((e=>!e.isRemoved))}get selectedDerivedPool(){return this.selectedPool?this.prepareDerivedPoolData(this.selectedPool,this.selectedAccountPool,this.liquidity):null}get items(){return[...this.list.map((e=>{const t=this.demeterAssetsData[e.baseAsset],a=this.demeterAssetsData[e.poolAsset],s=this.demeterAssetsData[e.rewardAsset],o=s?.symbol??"",l=r.FPNumber.fromCodecValue(this.getAssetFiatPrice({address:e.rewardAsset})??0),i=this.tokenInfos[e.rewardAsset],n=this.getAccountPool(e),c=!!n&&this.isActiveAccountPool(n),d=this.poolsData[g(e.baseAsset,e.poolAsset)],p=d?.priceCoefficient??r.FPNumber.ZERO,u=r.FPNumber.fromCodecValue(this.getAssetFiatPrice(a)??0).mul(p),m=d?.reserves?.[0]??r.FPNumber.ZERO,h=d?.reserves?.[1]??r.FPNumber.ZERO,f=d?.supply??r.FPNumber.ZERO,y=n?.pooledTokens??r.FPNumber.ZERO,v=e.isFarm?{address:d?.address??"",balance:f.toCodecString(),firstAddress:t.address??"",firstBalance:m.toCodecString(),secondAddress:a?.address??"",secondBalance:h.toCodecString(),poolShare:"1",reserveA:"1",reserveB:"1",totalSupply:"1"}:null,_=e.isFarm?[t,a]:[a],x=_.map((e=>e?.symbol??"")).join("-"),k=e.isFarm?"":a?.name??"",w=new r.FPNumber(e.depositFee??0).mul(r.FPNumber.HUNDRED),A=u.mul(e.totalTokensInPool),C=this.getEmission(e,i),F=this.getApr(C,A,l),P=(e.isFarm?[{asset:t,balance:f.isZero()?r.FPNumber.ZERO:m.mul(y).div(f)},{asset:a,balance:f.isZero()?r.FPNumber.ZERO:h.mul(y).div(f)}]:[{asset:a,balance:y}]).map((e=>({...e,balance:(0,b.Gc)(e.balance)})));return{assets:_,name:x,description:k,baseAsset:t,poolAsset:a,rewardAsset:s,rewardAssetSymbol:o,depositFee:w.toNumber(),depositFeeFormatted:(0,b.Gc)(w,!0),tvl:A.toNumber(),tvlFormatted:(0,b.kF)(A),apr:F.toNumber(),aprFormatted:(0,b.Gc)(F,!0),isAccountItem:c,accountTokens:P,liquidity:v}}))].sort(((e,t)=>(0,b.s$)({baseAsset:e.poolAsset,poolAsset:e.rewardAsset},{baseAsset:t.poolAsset,poolAsset:t.rewardAsset})))}get prefilteredItems(){return this.isAccountItemsOnly?this.items.filter((e=>e.isAccountItem)):this.items}get hasAprColumnData(){return this.items.some((e=>0!==e.apr))}async updateExploreData(){this.loading||await this.withLoading((async()=>{await this.withParentLoading((async()=>{const e={},t=this.isFarmingPage,a=this.list.map((e=>g(e.baseAsset,e.poolAsset))),s=[...new Set(a)];await Promise.allSettled(s.map((async a=>{if(!e[a]){const s=await this.getPoolData(a,t);s&&(e[a]=s)}}))),this.poolsData=Object.freeze(e)}))}))}async getPoolData(e,t){const[a,s]=e.split(";");if(t){const e=l.hi.poolXyk.getInfo(a,s);if(!e)return null;const t=e.address,o=await l.hi.api.query.poolXYK.totalIssuances(e.address),i=o.isEmpty?r.FPNumber.ZERO:new r.FPNumber(o),n=(await l.hi.poolXyk.getReserves(a,s)).map((e=>r.FPNumber.fromCodecValue(e))),c=n[1];return{priceCoefficient:i.isZero()?r.FPNumber.ZERO:c.mul(new r.FPNumber(2)).div(i),supply:i,reserves:n,address:t}}return{priceCoefficient:r.FPNumber.ONE}}};(0,o.__decorate)([(0,i.RL)("pools",{deep:!0})],h.prototype,"updatePoolsData",null),h=(0,o.__decorate)([(0,i.wA)({components:{CalculatorButton:(0,u.Y)(d.o.CalculatorButton),CalculatorDialog:(0,u.Y)(d.o.CalculatorDialog),PairTokenLogo:(0,m.kF)(c.z8.PairTokenLogo),SortButton:(0,m.kF)(c.z8.SortButton),DataRowSkeleton:(0,m.kF)(c.z8.DataRowSkeleton),TokenLogo:l.wx.TokenLogo,FormattedAmount:l.wx.FormattedAmount,HistoryPagination:l.wx.HistoryPagination}})],h);var f=h,y=(0,a(1001).Z)(f,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[t("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingState,expression:"loadingState"}],ref:"table",staticClass:"explore-table",attrs:{data:e.tableItems,"highlight-current-row":!1,size:"small"}},[t("s-table-column",{attrs:{width:"240",label:"#"},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"explore-table-item-index"},[t("span",{class:["explore-table-item-index--head",{active:e.isDefaultSort}],on:{click:e.handleResetSort}},[e._v(" # ")])]),t("div",{staticClass:"explore-table-item-logo"},[t("s-icon",{staticClass:"explore-table-item-logo--head",attrs:{name:"various-bone-24",size:"14px"}})],1),t("div",{staticClass:"explore-table-item-info explore-table-item-info--head"},[t("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.t("nameText")))])])]},proxy:!0},{key:"default",fn:function({$index:a,row:s}){return[t("span",{staticClass:"explore-table-item-index explore-table-item-index--body"},[e._v(e._s(a+e.startIndex+1))]),1===s.assets.length?t("token-logo",{key:"token",staticClass:"explore-table-item-logo",attrs:{token:s.assets[0]}}):t("pair-token-logo",{key:"pair",staticClass:"explore-table-item-logo",attrs:{"first-token":s.assets[0],"second-token":s.assets[1],size:"small"}}),t("div",{staticClass:"explore-table-item-info explore-table-item-info--body"},[t("div",{staticClass:"explore-table-item-name"},[e._v(e._s(s.name))]),s.description?t("div",{key:"description",staticClass:"explore-table__secondary"},[e._v(e._s(s.description))]):e._e()])]}}])}),t("s-table-column",{attrs:{width:"120","header-align":"left",align:"left"},scopedSlots:e._u([{key:"header",fn:function(){return[t("sort-button",{attrs:{name:"rewardAssetSymbol",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[t("span",{staticClass:"explore-table__primary"},[e._v("Reward")])])]},proxy:!0},{key:"default",fn:function({row:a}){return[t("div",{staticClass:"explore-table-cell"},[t("token-logo",{staticClass:"explore-table-item-logo explore-table-item-logo--plain",attrs:{size:"small","token-symbol":a.rewardAsset.symbol}}),t("div",{staticClass:"explore-table-item-name"},[e._v(e._s(a.rewardAsset.symbol))])],1)]}}])}),t("s-table-column",{attrs:{width:"140","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[t("sort-button",{attrs:{name:"apr",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[t("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.TranslationConsts.APR))])])]},proxy:!0},{key:"default",fn:function({row:a}){return[t("data-row-skeleton",{attrs:{loading:!e.hasAprColumnData,rect:"",circle:""}},[t("span",{staticClass:"explore-table__accent"},[e._v(e._s(a.aprFormatted))]),t("calculator-button",{nativeOn:{click:function(t){return e.showPoolCalculator({baseAsset:a.baseAsset.address,poolAsset:a.poolAsset.address,rewardAsset:a.rewardAsset.address,liquidity:a.liquidity})}}})],1)]}}])}),t("s-table-column",{attrs:{width:"80","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[t("sort-button",{attrs:{name:"depositFee",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[t("span",{staticClass:"explore-table__primary"},[e._v("Fee")])])]},proxy:!0},{key:"default",fn:function({row:t}){return[e._v(" "+e._s(t.depositFeeFormatted)+" ")]}}])}),e.isLoggedIn?t("s-table-column",{key:"logged",attrs:{width:"140","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[t("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.t("balanceText")))])]},proxy:!0},{key:"default",fn:function({row:a}){return[t("div",{staticClass:"explore-table-item-tokens"},e._l(a.accountTokens,(function({asset:a,balance:s},o){return t("div",{key:o,staticClass:"explore-table-cell"},[t("formatted-amount",{staticClass:"explore-table-item-token",attrs:{"value-can-be-hidden":"","font-size-rate":e.FontSizeRate.SMALL,value:s}}),t("token-logo",{staticClass:"explore-table-item-logo explore-table-item-logo--plain",attrs:{size:"small",token:a}})],1)})),0)]}}],null,!1,2195178740)}):e._e(),t("s-table-column",{attrs:{width:"104","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[t("sort-button",{attrs:{name:"tvl",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[t("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.TranslationConsts.TVL))]),t("s-tooltip",{attrs:{"border-radius":"mini",content:e.t("tooltips.tvl")}},[t("s-icon",{attrs:{name:"info-16",size:"14px"}})],1)],1)]},proxy:!0},{key:"default",fn:function({row:a}){return[t("data-row-skeleton",{attrs:{loading:!e.pricesAvailable,rect:""}},[t("formatted-amount",{staticClass:"explore-table-item-price explore-table-item-amount",attrs:{"is-fiat-value":"","font-weight-rate":e.FontWeightRate.MEDIUM,value:a.tvlFormatted.amount}},[e._v(" "+e._s(a.tvlFormatted.suffix)+" ")])],1)]}}])})],1),t("history-pagination",{staticClass:"explore-table-pagination",attrs:{"current-page":e.currentPage,"page-amount":e.pageAmount,total:e.total,"last-page":e.lastPage,loading:e.loadingState},on:{"pagination-click":e.handlePaginationClick}}),t("calculator-dialog",e._b({attrs:{visible:e.showCalculatorDialog,liquidity:e.liquidity},on:{"update:visible":function(t){e.showCalculatorDialog=t}}},"calculator-dialog",e.selectedDerivedPool,!1))],1)}),[],!1,null,null,null).exports}}]);