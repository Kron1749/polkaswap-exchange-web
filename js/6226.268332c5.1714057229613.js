"use strict";(self.webpackChunkpolkaswap_exchange_web=self.webpackChunkpolkaswap_exchange_web||[]).push([[6226],{56226:function(e,t,i){i.r(t),i.d(t,{default:function(){return F}});var o=i(23166),s=(i(70560),i(70655)),r=i(36930),n=i(82753),a=i(22620),d=i(89445),u=i(55174),l=i(47614),c=i(57478),m=i(68282),v=i(69781),h=i(49053),p=i(80938),y=i(50961);let k=class extends((0,d.Wr)(a.tA.NetworkFeeWarningMixin,a.tA.FormattedAmountMixin,a.tA.TransactionMixin,u.Z,l.Z,c.Z)){constructor(...e){super(...e),(0,o.Z)(this,"XOR_SYMBOL",n.XOR.symbol),(0,o.Z)(this,"MAX_PART",100),(0,o.Z)(this,"FocusedField",p.G),(0,o.Z)(this,"liquidityAmount",void 0),(0,o.Z)(this,"focusedField",void 0),(0,o.Z)(this,"firstTokenAmount",void 0),(0,o.Z)(this,"secondTokenAmount",void 0),(0,o.Z)(this,"removePart",void 0),(0,o.Z)(this,"xor",void 0),(0,o.Z)(this,"liquidityBalanceFull",void 0),(0,o.Z)(this,"liquidityBalance",void 0),(0,o.Z)(this,"demeterLockedBalance",void 0),(0,o.Z)(this,"ceresLockedBalance",void 0),(0,o.Z)(this,"liquidity",void 0),(0,o.Z)(this,"firstToken",void 0),(0,o.Z)(this,"secondToken",void 0),(0,o.Z)(this,"firstTokenBalance",void 0),(0,o.Z)(this,"secondTokenBalance",void 0),(0,o.Z)(this,"shareOfPool",void 0),(0,o.Z)(this,"price",void 0),(0,o.Z)(this,"priceReversed",void 0),(0,o.Z)(this,"setAddresses",void 0),(0,o.Z)(this,"setFocusedField",void 0),(0,o.Z)(this,"resetFocusedField",void 0),(0,o.Z)(this,"setRemovePart",void 0),(0,o.Z)(this,"removeLiquidity",void 0),(0,o.Z)(this,"resetData",void 0),(0,o.Z)(this,"setFirstTokenAmount",void 0),(0,o.Z)(this,"setSecondTokenAmount",void 0),(0,o.Z)(this,"sliderInput",void 0),(0,o.Z)(this,"sliderDragButton",void 0)}liquidityChange(){switch(this.focusedField){case p.G.First:case p.G.Second:{const e=this.focusedField===p.G.First,t=Number(this.getTokenMaxAmount(e?this.firstTokenBalance:this.secondTokenBalance)),i=Number(e?this.firstTokenAmount:this.secondTokenAmount);(e?this.setFirstTokenAmount:this.setSecondTokenAmount)(String(Number.isFinite(t)?Math.min(t,i):i));break}default:this.setRemovePart(this.removePart)}}async mounted(){await this.withParentLoading((async()=>{this.setData({firstAddress:this.firstRouteAddress,secondAddress:this.secondRouteAddress}),this.addListenerToSliderDragButton()}))}beforeDestroy(){this.removeListenerFromSliderDragButton(),this.resetData()}get sliderValue(){return this.removePart?Number(this.removePart):void 0}get isEmptyAmount(){return!Number(this.liquidityAmount)||!this.firstTokenAmount||!this.secondTokenAmount}get liquidityLocked(){return this.liquidityBalance.isZero()}get locks(){return[{balance:this.demeterLockedBalance,lock:"Demeter Farming"},{balance:this.ceresLockedBalance,lock:"Ceres Liquidity Locker"}].reduce(((e,{balance:t,lock:i})=>(t.isZero()||e.push({lock:i,percent:this.getLockedPercent(t)}),e)),[])}get isInsufficientBalance(){const{liquidityBalance:e,firstTokenBalance:t,secondTokenBalance:i}=this,o=this.getFPNumber(this.liquidityAmount),s=this.getFPNumber(this.firstTokenAmount),n=this.getFPNumber(this.secondTokenAmount);return r.FPNumber.gt(o,e)||r.FPNumber.gt(s,t)||r.FPNumber.gt(n,i)}get isInsufficientXorForFee(){return!!this.xor&&(0,y.LG)(this.xor,this.networkFee)}get removePartCharClass(){return`${{3:"three",2:"two"}[this.removePart.length]??"one"}-char`}get networkFee(){return this.networkFees[r.Operation.RemoveLiquidity]}get formattedFee(){return this.formatCodecNumber(this.networkFee)}get isXorSufficientForNextOperation(){const e={type:r.Operation.RemoveLiquidity};return this.firstToken?.address===n.XOR.address&&(e.amount=this.getFPNumber(this.firstTokenAmount),e.isXor=!0),this.isXorSufficientForNextTx(e)}get isMaxButtonAvailable(){return!this.shouldBalanceBeHidden&&(!this.liquidityLocked&&Number(this.removePart)!==this.MAX_PART)}async setData(e){if(this.setAddresses({firstAddress:e.firstAddress,secondAddress:e.secondAddress}),!this.liquidity)return this.handleBack()}handleRemovePartChange(e){Number(e)!==Number(this.removePart)&&this.setRemovePart(String(e))}focusSliderInput(){this.setFocusedField(p.G.Percent),this.sliderInput&&this.sliderInput.focus()}getTokenMaxAmount(e){return e.toString()}getLockedPercent(e){const t=e.div(this.liquidityBalanceFull).mul(r.FPNumber.HUNDRED);return(0,y.Gc)(t,!0)}async handleTokenChange(e,t){await t(e)}async handleConfirmRemoveLiquidity(){await this.handleConfirmDialog((async()=>{await this.withNotifications(this.removeLiquidity),this.handleBack()}))}handleBack(){v.ZP.currentRoute.name===m.sn.RemoveLiquidity&&v.ZP.push({name:m.sn.Pool})}async handleRemoveLiquidity(){if(this.allowFeePopup&&!this.isXorSufficientForNextOperation){if(this.openWarningFeeDialog(),await this.waitOnFeeWarningConfirmation(),!this.isWarningFeeDialogConfirmed)return;this.isWarningFeeDialogConfirmed=!1}this.openConfirmDialog()}addListenerToSliderDragButton(){this.sliderDragButton=this.$el.querySelector(".slider-container .el-slider__button"),this.sliderInput=this.$el.querySelector(".s-input--remove-part .el-input__inner"),this.sliderDragButton&&this.sliderDragButton.addEventListener("mousedown",this.focusSliderInput)}removeListenerFromSliderDragButton(){this.sliderDragButton&&this.$el.removeEventListener("mousedown",this.sliderDragButton)}};(0,s.__decorate)([h.SB.removeLiquidity.liquidityAmount],k.prototype,"liquidityAmount",void 0),(0,s.__decorate)([h.SB.removeLiquidity.focusedField],k.prototype,"focusedField",void 0),(0,s.__decorate)([h.SB.removeLiquidity.firstTokenAmount],k.prototype,"firstTokenAmount",void 0),(0,s.__decorate)([h.SB.removeLiquidity.secondTokenAmount],k.prototype,"secondTokenAmount",void 0),(0,s.__decorate)([h.SB.removeLiquidity.removePart],k.prototype,"removePart",void 0),(0,s.__decorate)([h.Yn.assets.xor],k.prototype,"xor",void 0),(0,s.__decorate)([h.Yn.removeLiquidity.liquidityBalanceFull],k.prototype,"liquidityBalanceFull",void 0),(0,s.__decorate)([h.Yn.removeLiquidity.liquidityBalance],k.prototype,"liquidityBalance",void 0),(0,s.__decorate)([h.Yn.removeLiquidity.demeterLockedBalance],k.prototype,"demeterLockedBalance",void 0),(0,s.__decorate)([h.Yn.removeLiquidity.ceresLockedBalance],k.prototype,"ceresLockedBalance",void 0),(0,s.__decorate)([h.Yn.removeLiquidity.liquidity],k.prototype,"liquidity",void 0),(0,s.__decorate)([h.Yn.removeLiquidity.firstToken],k.prototype,"firstToken",void 0),(0,s.__decorate)([h.Yn.removeLiquidity.secondToken],k.prototype,"secondToken",void 0),(0,s.__decorate)([h.Yn.removeLiquidity.firstTokenBalance],k.prototype,"firstTokenBalance",void 0),(0,s.__decorate)([h.Yn.removeLiquidity.secondTokenBalance],k.prototype,"secondTokenBalance",void 0),(0,s.__decorate)([h.Yn.removeLiquidity.shareOfPool],k.prototype,"shareOfPool",void 0),(0,s.__decorate)([h.Yn.removeLiquidity.price],k.prototype,"price",void 0),(0,s.__decorate)([h.Yn.removeLiquidity.priceReversed],k.prototype,"priceReversed",void 0),(0,s.__decorate)([h.QF.removeLiquidity.setAddresses],k.prototype,"setAddresses",void 0),(0,s.__decorate)([h.QF.removeLiquidity.setFocusedField],k.prototype,"setFocusedField",void 0),(0,s.__decorate)([h.QF.removeLiquidity.resetFocusedField],k.prototype,"resetFocusedField",void 0),(0,s.__decorate)([h.aD.removeLiquidity.setRemovePart],k.prototype,"setRemovePart",void 0),(0,s.__decorate)([h.aD.removeLiquidity.removeLiquidity],k.prototype,"removeLiquidity",void 0),(0,s.__decorate)([h.aD.removeLiquidity.resetData],k.prototype,"resetData",void 0),(0,s.__decorate)([h.aD.removeLiquidity.setFirstTokenAmount],k.prototype,"setFirstTokenAmount",void 0),(0,s.__decorate)([h.aD.removeLiquidity.setSecondTokenAmount],k.prototype,"setSecondTokenAmount",void 0),(0,s.__decorate)([(0,d.RL)("liquidity",{deep:!0})],k.prototype,"liquidityChange",null),k=(0,s.__decorate)([(0,d.wA)({components:{RemoveLiquidityConfirm:(0,v.kF)(m.z8.RemoveLiquidityConfirm),RemoveLiquidityTransactionDetails:(0,v.kF)(m.z8.RemoveLiquidityTransactionDetails),GenericPageHeader:(0,v.kF)(m.z8.GenericPageHeader),SlippageTolerance:(0,v.kF)(m.z8.SlippageTolerance),NetworkFeeWarningDialog:(0,v.kF)(m.z8.NetworkFeeWarningDialog),TokenInput:(0,v.kF)(m.z8.TokenInput),InfoLine:a.wx.InfoLine}})],k);var f=k,F=(0,i(1001).Z)(f,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.parentLoading,expression:"parentLoading"}],staticClass:"container container--remove-liquidity"},[t("generic-page-header",{attrs:{"has-button-back":"",title:e.t("removeLiquidity.title"),tooltip:e.t("removeLiquidity.description")},on:{back:e.handleBack}}),t("s-form",{staticClass:"el-form--actions",attrs:{"show-message":!1}},[t("s-float-input",{ref:"removePart",class:["s-input--remove-part",e.removePartCharClass],attrs:{size:"medium",value:e.removePart,decimals:0,disabled:e.liquidityLocked,max:e.MAX_PART},on:{input:e.handleRemovePartChange,focus:function(t){return e.setFocusedField(e.FocusedField.Percent)},blur:e.resetFocusedField}},[t("div",{staticClass:"input-title",attrs:{slot:"top"},slot:"top"},[e._v(e._s(e.t("removeLiquidity.amount")))]),t("div",{staticClass:"el-buttons el-buttons--between",attrs:{slot:"right"},slot:"right"},[t("span",{staticClass:"percent"},[e._v("%")]),e.isMaxButtonAvailable?t("s-button",{staticClass:"el-button--max s-typography-button--small",attrs:{type:"primary",alternative:"",size:"mini","border-radius":"mini"},on:{click:function(t){return t.stopPropagation(),e.handleRemovePartChange(e.MAX_PART)}}},[e._v(" "+e._s(e.t("buttons.max"))+" ")]):e._e()],1),t("div",{attrs:{slot:"bottom"},slot:"bottom"},[t("s-slider",{staticClass:"slider-container",attrs:{value:e.sliderValue,disabled:e.liquidityLocked,"show-tooltip":!1},on:{input:e.handleRemovePartChange}}),e._l(e.locks,(function({percent:i,lock:o}){return t("div",{key:o,staticClass:"input-line input-line--footer locked-part"},[t("span",{staticClass:"locked-part-percent"},[e._v(e._s(i))]),e._v(" "+e._s(e.t("removeLiquidity.locked",{lock:o}))+" ")])}))],2)]),t("s-icon",{staticClass:"icon-divider",attrs:{name:"arrows-arrow-bottom-24"}}),t("token-input",{attrs:{disabled:e.liquidityLocked,max:e.getTokenMaxAmount(e.firstTokenBalance),title:e.t("removeLiquidity.output"),token:e.firstToken,value:e.firstTokenAmount},on:{input:e.setFirstTokenAmount,focus:function(t){return e.setFocusedField(e.FocusedField.First)},blur:e.resetFocusedField},scopedSlots:e._u([{key:"balance",fn:function(){return[e._v("-")]},proxy:!0}])}),t("s-icon",{staticClass:"icon-divider",attrs:{name:"plus-16"}}),t("token-input",{attrs:{disabled:e.liquidityLocked,max:e.getTokenMaxAmount(e.secondTokenBalance),title:e.t("removeLiquidity.output"),token:e.secondToken,value:e.secondTokenAmount},on:{input:e.setSecondTokenAmount,focus:function(t){return e.setFocusedField(e.FocusedField.Second)},blur:e.resetFocusedField},scopedSlots:e._u([{key:"balance",fn:function(){return[e._v("-")]},proxy:!0}])}),t("slippage-tolerance",{staticClass:"slippage-tolerance-settings"}),t("s-button",{staticClass:"action-button s-typography-button--large",attrs:{type:"primary","border-radius":"small",disabled:e.liquidityLocked||e.isEmptyAmount||e.isInsufficientBalance||e.isInsufficientXorForFee},on:{click:e.handleRemoveLiquidity}},[e.isEmptyAmount?[e._v(" "+e._s(e.t("buttons.enterAmount"))+" ")]:e.isInsufficientBalance?[e._v(" "+e._s(e.t("insufficientBalanceText",{tokenSymbol:e.t("removeLiquidity.liquidity")}))+" ")]:e.isInsufficientXorForFee?[e._v(" "+e._s(e.t("insufficientBalanceText",{tokenSymbol:e.XOR_SYMBOL}))+" ")]:[e._v(" "+e._s(e.t("removeLiquidity.remove"))+" ")]],2),e.price||e.priceReversed||e.networkFee||e.shareOfPool?t("remove-liquidity-transaction-details",{staticClass:"info-line-container",attrs:{"info-only":!1}}):e._e()],1),t("remove-liquidity-confirm",{attrs:{visible:e.showConfirmDialog,"parent-loading":e.parentLoading||e.loading},on:{"update:visible":function(t){e.showConfirmDialog=t},confirm:e.handleConfirmRemoveLiquidity}}),t("network-fee-warning-dialog",{attrs:{visible:e.showWarningFeeDialog,fee:e.formattedFee},on:{"update:visible":function(t){e.showWarningFeeDialog=t},confirm:e.confirmNetworkFeeWariningDialog}})],1)}),[],!1,null,"d7fec76c",null).exports}}]);