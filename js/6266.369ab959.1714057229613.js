"use strict";(self.webpackChunkpolkaswap_exchange_web=self.webpackChunkpolkaswap_exchange_web||[]).push([[6266],{96266:function(t,e,a){a.r(e),a.d(e,{default:function(){return w}});var s=a(23166),n=(a(70560),a(70655)),o=a(36930),i=a(22620),r=a(27484),l=a.n(r),u=a(25387),d=a.n(u),c=a(89445),p=a(25e3),m=a(68282),h=a(69781),f=a(49053),g=a(50961);let k=class extends((0,c.Wr)(p.Z)){constructor(...t){super(...t),(0,s.Z)(this,"soraNetwork",void 0),(0,s.Z)(this,"tokenFrom",void 0),(0,s.Z)(this,"tokenTo",void 0),(0,s.Z)(this,"assetsDataTable",void 0),(0,s.Z)(this,"pageAmount",8),(0,s.Z)(this,"operations",[o.Operation.Swap]),(0,s.Z)(this,"interval",null),(0,s.Z)(this,"updateTransactions",(0,g._1)(this.updateData,250,{leading:!1})),(0,s.Z)(this,"intervalTimestamp",0),(0,s.Z)(this,"fromTimestamp",l()().subtract(1,"month").startOf("day").unix()),(0,s.Z)(this,"totalCount",0),(0,s.Z)(this,"transactions",[])}resetData(t,e){d()(t)(e)||(this.resetPage(),this.updateTransactions())}get loadingState(){return this.parentLoading||this.loading}get total(){return this.totalCount}get tableItems(){return this.transactions.map((t=>{const e=t.id??"",a=t.blockId??"",s=t.from??"",n=t.assetAddress?this.assetsDataTable[t.assetAddress]:null,i=n?.symbol??"??",r=t.asset2Address?this.assetsDataTable[t.asset2Address]:null,u=r?.symbol??"??",d=(0,g.iL)(new o.FPNumber(t.amount??0)),c=(0,g.iL)(new o.FPNumber(t.amount2??0)),p=l()(t.startTime),m=(0,g.$1)(this.soraNetwork,e,a);return{address:s,inputAsset:n,inputAssetSymbol:i,outputAsset:r,outputAssetSymbol:u,inputAmount:d,outputAmount:c,datetime:{date:p.format("M/DD"),time:p.format("HH:mm:ss")},links:m}}))}get assetsAddresses(){return[this.tokenFrom,this.tokenTo].filter((t=>!!t)).map((t=>t.address)).sort(((t,e)=>t<e?-1:t>e?1:0))}createFilter(t){const e=(0,i.HZ)(),{operations:a,tokenFrom:s,tokenTo:n}=this,o=s?.address,r=n?.address?[n.address]:[];return e.historyElementsFilter({operations:a,assetAddress:o,timestamp:t,query:{assetsAddresses:r}})}async onPaginationClick(t){this.handlePaginationClick(t),this.updateTransactions()}async updateData(){this.resetDataSubscription(),await this.fetchData(),1===this.currentPage&&(this.updateIntervalTimestamp(),this.subscribeOnData())}async fetchData(){await this.withLoading((async()=>{await this.withParentLoading((async()=>{const{pageAmount:t,currentPage:e}=this,a={filter:this.createFilter(this.fromTimestamp),first:t,offset:t*(e-1)},{totalCount:s,transactions:n}=await this.requestData(a);this.totalCount=s,this.transactions=n}))}))}async fetchDataUpdates(){const t={filter:this.createFilter(this.intervalTimestamp)},{transactions:e,totalCount:a}=await this.requestData(t);this.transactions=[...e,...this.transactions].slice(0,this.pageAmount),this.totalCount=this.totalCount+a,this.updateIntervalTimestamp()}async requestData(t){const e=(0,i.HZ)(),a=await e.services.explorer.account.getHistory(t);if(!a)return{transactions:[],totalCount:0};const{nodes:s,totalCount:n}=a,o=[];for(const t of s){const a=await e.services.dataParser.parseTransactionAsHistoryItem(t);a&&o.push(a)}return{transactions:o,totalCount:n}}updateIntervalTimestamp(){this.intervalTimestamp=Math.floor((this.transactions[0]?.startTime??0)/1e3)}subscribeOnData(){this.resetDataSubscription(),this.interval=setInterval((()=>this.fetchDataUpdates()),15e3)}resetDataSubscription(){this.interval&&clearInterval(this.interval),this.interval=null}beforeDestroy(){this.resetDataSubscription()}};(0,n.__decorate)([f.SB.wallet.settings.soraNetwork],k.prototype,"soraNetwork",void 0),(0,n.__decorate)([f.Yn.swap.tokenFrom],k.prototype,"tokenFrom",void 0),(0,n.__decorate)([f.Yn.swap.tokenTo],k.prototype,"tokenTo",void 0),(0,n.__decorate)([f.Yn.wallet.account.assetsDataTable],k.prototype,"assetsDataTable",void 0),(0,n.__decorate)([(0,c.RL)("assetsAddresses",{immediate:!0})],k.prototype,"resetData",null),k=(0,n.__decorate)([(0,c.wA)({components:{BaseWidget:(0,h.kF)(m.z8.BaseWidget),LinksDropdown:(0,h.kF)(m.z8.LinksDropdown),TokenLogo:i.wx.TokenLogo,FormattedAmount:i.wx.FormattedAmount,FormattedAddress:i.wx.FormattedAddress,HistoryPagination:i.wx.HistoryPagination}})],k);var b=k,w=(0,a(1001).Z)(b,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("base-widget",{staticClass:"swap-transactions-widget",attrs:{extensive:"",title:t.tc("transactionText",2)}},[e("s-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingState,expression:"loadingState"}],ref:"table",staticClass:"explore-table",attrs:{data:t.tableItems,"highlight-current-row":!1,size:"small"}},[e("s-table-column",{attrs:{width:"74"},scopedSlots:t._u([{key:"header",fn:function(){return[e("span",[t._v(t._s(t.t("transaction.startTime")))])]},proxy:!0},{key:"default",fn:function({row:a}){return[e("div",{staticClass:"explore-table-item-date"},[e("div",[t._v(t._s(a.datetime.date))]),e("div",[t._v(t._s(a.datetime.time))])])]}}])}),e("s-table-column",{attrs:{width:"106","header-align":"right",align:"right"},scopedSlots:t._u([{key:"header",fn:function(){return[e("span",[t._v(t._s(t.t("removeLiquidity.input")))])]},proxy:!0},{key:"default",fn:function({row:a}){return[e("formatted-amount",{staticClass:"explore-table-item-token",attrs:{"font-size-rate":t.FontSizeRate.SMALL,value:a.inputAmount}})]}}])}),e("s-table-column",{attrs:{width:"106","header-align":"left",align:"left"},scopedSlots:t._u([{key:"header",fn:function(){return[e("span",[t._v(t._s(t.t("removeLiquidity.output")))])]},proxy:!0},{key:"default",fn:function({row:a}){return[e("formatted-amount",{staticClass:"explore-table-item-token",attrs:{"font-size-rate":t.FontSizeRate.SMALL,value:a.outputAmount}})]}}])}),e("s-table-column",{attrs:{width:"112","header-align":"left",align:"left"},scopedSlots:t._u([{key:"header",fn:function(){return[e("span",[t._v(t._s(t.t("transfers.from")))])]},proxy:!0},{key:"default",fn:function({row:a}){return[e("div",{staticClass:"explore-table-cell"},[e("token-logo",{staticClass:"explore-table-item-logo explore-table-item-logo--plain",attrs:{size:"small",token:a.inputAsset}}),e("span",{staticClass:"explore-table-item-token"},[t._v(t._s(a.inputAssetSymbol))])],1)]}}])}),e("s-table-column",{attrs:{width:"112","header-align":"left",align:"left"},scopedSlots:t._u([{key:"header",fn:function(){return[e("span",[t._v(t._s(t.t("transfers.to")))])]},proxy:!0},{key:"default",fn:function({row:a}){return[e("div",{staticClass:"explore-table-cell"},[e("token-logo",{staticClass:"explore-table-item-logo explore-table-item-logo--plain",attrs:{size:"small",token:a.outputAsset}}),e("span",{staticClass:"explore-table-item-token"},[t._v(t._s(a.outputAssetSymbol))])],1)]}}])}),e("s-table-column",{attrs:{width:"94"},scopedSlots:t._u([{key:"header",fn:function(){return[e("span",[t._v(t._s(t.tc("accountText",1)))])]},proxy:!0},{key:"default",fn:function({row:t}){return[e("formatted-address",{attrs:{value:t.address,symbols:8}})]}}])}),e("s-table-column",{attrs:{width:"48","header-align":"center"},scopedSlots:t._u([{key:"header",fn:function(){return[e("s-icon",{attrs:{name:"basic-eye-no-24",size:"16px"}})]},proxy:!0},{key:"default",fn:function({row:a}){return[a.links.length?e("links-dropdown",{attrs:{links:a.links}}):t._e()]}}])})],1),e("history-pagination",{staticClass:"explore-table-pagination",attrs:{"current-page":t.currentPage,"page-amount":t.pageAmount,total:t.total,loading:t.loadingState,"last-page":t.lastPage},on:{"pagination-click":t.onPaginationClick}})],1)}),[],!1,null,"7ff27fca",null).exports}}]);