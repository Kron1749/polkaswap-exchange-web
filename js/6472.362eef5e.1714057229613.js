"use strict";(self.webpackChunkpolkaswap_exchange_web=self.webpackChunkpolkaswap_exchange_web||[]).push([[6472],{6472:function(e,t,r){r.r(t),r.d(t,{default:function(){return v}});var o=r(23166),i=(r(70560),r(70655)),s=r(99278),n=r(22620),c=r(89445),d=r(89334),l=r(68282),a=r(69781),u=r(49053),h=r(74655),p=r(50961);let k=class extends((0,c.Wr)(d.Z,n.tA.LoadingMixin,n.tA.TransactionMixin)){constructor(...e){super(...e),(0,o.Z)(this,"Filter",h.wn),(0,o.Z)(this,"Cancel",h.$j),(0,o.Z)(this,"userLimitOrders",void 0),(0,o.Z)(this,"accountAddress",void 0),(0,o.Z)(this,"orderBookId",void 0),(0,o.Z)(this,"nodeIsConnected",void 0),(0,o.Z)(this,"subscribeToUserLimitOrders",void 0),(0,o.Z)(this,"unsubscribeFromUserLimitOrders",void 0),(0,o.Z)(this,"ordersToBeCancelled",void 0),(0,o.Z)(this,"setOrdersToBeCancelled",void 0),(0,o.Z)(this,"currentOrderBook",void 0),(0,o.Z)(this,"isLoggedIn",void 0),(0,o.Z)(this,"confirmCancelOrderVisibility",!1),(0,o.Z)(this,"currentFilter",h.wn.open),(0,o.Z)(this,"openOrdersLoading",!1)}async updateSubscription(){this.openOrdersLoading=!0,await this.subscribeToUserLimitOrders(),await(0,p.gw)(2e3),this.openOrdersLoading=!1}get openOrdersText(){return this.t("orderBook.history.openOrders",{value:this.openOrdersCount})}get cancelText(){return this.hasSelectedForCancellation?this.t("orderBook.history.cancel",{value:`(${this.ordersToBeCancelled.length})`}):this.t("orderBook.history.cancel")}get cancelAllText(){return this.t("orderBook.history.cancelAll")}get hasSelectedForCancellation(){return this.ordersToBeCancelled.length>0}get isBookStopped(){return!this.currentOrderBook||this.currentOrderBook.status===s.OrderBookStatus.Stop}get openOrdersCount(){if(!this.isLoggedIn)return"";const e=this.userLimitOrders.length;return e>0?`(${e})`:""}get isCancelAllInactive(){return this.loading||this.isBookStopped||!this.userLimitOrders.length}get isCancelMultipleInactive(){return this.loading||this.isBookStopped||!this.hasSelectedForCancellation}connectAccount(){a.ZP.push({name:l.sn.Wallet})}switchFilter(e){this.currentFilter=e}openConfirmCancelDialog(){this.isBookStopped||this.userLimitOrders.length&&(this.confirmCancelOrderVisibility=!0)}async handleCancel(e){if(this.loading||this.isBookStopped||!this.userLimitOrders.length)return;const t=e===h.$j.multiple?this.ordersToBeCancelled:this.userLimitOrders;t.length&&await this.withNotifications((async()=>{const{orderBookId:{base:e,quote:r}}=t[0],o=t.map((e=>e.id));o.length>1?await n.hi.orderBook.cancelLimitOrderBatch(e,r,o):await n.hi.orderBook.cancelLimitOrder(e,r,o[0]),this.setOrdersToBeCancelled([])}))}beforeDestroy(){this.unsubscribeFromUserLimitOrders()}};(0,i.__decorate)([u.SB.orderBook.userLimitOrders],k.prototype,"userLimitOrders",void 0),(0,i.__decorate)([u.Yn.orderBook.accountAddress],k.prototype,"accountAddress",void 0),(0,i.__decorate)([u.Yn.orderBook.orderBookId],k.prototype,"orderBookId",void 0),(0,i.__decorate)([u.Yn.settings.nodeIsConnected],k.prototype,"nodeIsConnected",void 0),(0,i.__decorate)([u.aD.orderBook.subscribeToUserLimitOrders],k.prototype,"subscribeToUserLimitOrders",void 0),(0,i.__decorate)([u.aD.orderBook.unsubscribeFromUserLimitOrders],k.prototype,"unsubscribeFromUserLimitOrders",void 0),(0,i.__decorate)([u.SB.orderBook.ordersToBeCancelled],k.prototype,"ordersToBeCancelled",void 0),(0,i.__decorate)([u.QF.orderBook.setOrdersToBeCancelled],k.prototype,"setOrdersToBeCancelled",void 0),(0,i.__decorate)([u.Yn.orderBook.currentOrderBook],k.prototype,"currentOrderBook",void 0),(0,i.__decorate)([u.Yn.wallet.account.isLoggedIn],k.prototype,"isLoggedIn",void 0),(0,i.__decorate)([(0,c.RL)("orderBookId",{immediate:!0}),(0,c.RL)("accountAddress"),(0,c.RL)("nodeIsConnected")],k.prototype,"updateSubscription",null),k=(0,i.__decorate)([(0,c.wA)({components:{BaseWidget:(0,a.kF)(l.z8.BaseWidget),AllOrders:(0,a.kF)(l.z8.AllOrders),OpenOrders:(0,a.kF)(l.z8.OpenOrders),CancelConfirm:(0,a.kF)(l.z8.CancelOrders)}})],k);var y=k,v=(0,r(1001).Z)(y,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("base-widget",{staticClass:"order-history-widget s-flex-column",attrs:{extensive:"",delimeter:""},scopedSlots:e._u([{key:"title",fn:function(){return[t("div",{staticClass:"order-history-buttons order-history-buttons--filter-buttons"},[t("span",{class:["order-history-button",{active:e.currentFilter===e.Filter.open}],on:{click:function(t){return e.switchFilter(e.Filter.open)}}},[e._v(" "+e._s(e.openOrdersText)+" ")]),t("span",{class:["order-history-button",{active:e.currentFilter===e.Filter.all}],on:{click:function(t){return e.switchFilter(e.Filter.all)}}},[e._v(" "+e._s(e.t("orderBook.history.orderHistory"))+" ")]),t("span",{class:["order-history-button",{active:e.currentFilter===e.Filter.executed}],on:{click:function(t){return e.switchFilter(e.Filter.executed)}}},[e._v(" "+e._s(e.t("orderBook.history.tradeHistory"))+" ")])]),e.isLoggedIn?t("div",{staticClass:"order-history-buttons order-history-buttons--cancel-buttons"},[t("span",{class:["order-history-button","order-history-button--cancel",{inactive:e.isCancelMultipleInactive}],on:{click:function(t){return e.handleCancel(e.Cancel.multiple)}}},[e._v(" "+e._s(e.cancelText)+" ")]),t("span",{class:["order-history-button","order-history-button--cancel",{inactive:e.isCancelAllInactive}],on:{click:e.openConfirmCancelDialog}},[e._v(" "+e._s(e.cancelAllText)+" ")])]):e._e()]},proxy:!0}])},[e.isLoggedIn?t("div",{staticClass:"order-history-main s-flex-column"},[e.currentFilter===e.Filter.open?t("open-orders",{attrs:{"parent-loading":e.openOrdersLoading}}):t("all-orders",{attrs:{filter:e.currentFilter}})],1):t("div",{staticClass:"order-history-connect-account"},[t("div",{staticClass:"order-history-connect-account-button"},[t("h4",{staticClass:"h4"},[e._v(e._s(e.t("orderBook.history.connect")))]),t("s-button",{staticClass:"btn s-typography-button--medium",attrs:{type:"primary"},on:{click:e.connectAccount}},[e._v(" "+e._s(e.t("connectWalletText"))+" ")])],1)]),t("cancel-confirm",{attrs:{visible:e.confirmCancelOrderVisibility},on:{"update:visible":function(t){e.confirmCancelOrderVisibility=t},confirm:e.handleCancel}})],1)}),[],!1,null,"8c549394",null).exports}}]);