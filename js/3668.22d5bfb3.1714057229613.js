"use strict";(self.webpackChunkpolkaswap_exchange_web=self.webpackChunkpolkaswap_exchange_web||[]).push([[3668],{83668:function(t,e,s){s.r(e),s.d(e,{default:function(){return g}});var i=s(23166),n=s(70655),a=s(22620),o=s(89445),r=s(89334),c=s(68282),d=s(69781),u=s(49053),h=s(25825),l=s(25108);let p=class extends((0,o.Wr)(r.Z,a.tA.LoadingMixin,a.tA.NotificationMixin)){constructor(...t){super(...t),(0,i.Z)(this,"authLogin",void 0),(0,i.Z)(this,"userInfo",void 0),(0,i.Z)(this,"attemptCounter",void 0),(0,i.Z)(this,"wantsToPassKycAgain",void 0),(0,i.Z)(this,"currentStatus",void 0),(0,i.Z)(this,"isEuroBalanceEnough",void 0),(0,i.Z)(this,"setWillToPassKycAgain",void 0),(0,i.Z)(this,"setReferenceNumber",void 0),(0,i.Z)(this,"getUserStatus",void 0),(0,i.Z)(this,"getUserIban",void 0),(0,i.Z)(this,"initPayWingsAuthSdk",void 0),(0,i.Z)(this,"getUserKycAttempt",void 0),(0,i.Z)(this,"inputOtp",void 0),(0,i.Z)(this,"smsCountDown",""),(0,i.Z)(this,"smsResendCount",59),(0,i.Z)(this,"verificationCode",""),(0,i.Z)(this,"smsSent",!1),(0,i.Z)(this,"sendOtpBtnLoading",!1),(0,i.Z)(this,"notFoundPhoneWhenApplied",!1),(0,i.Z)(this,"showSelectCountryDialog",!1),(0,i.Z)(this,"selectedCountry",null),(0,i.Z)(this,"phoneNumber","")}handleSmsCountChange(t){const e=t.toString().length>1?"":"0";this.smsCountDown=`0:${e}${t}`}get hasFreeAttempts(){return this.attemptCounter.hasFreeAttempts}verifyCode(){this.authLogin.PayWingsOtpCredentialVerification(this.verificationCode).catch((t=>{this.sendOtpBtnLoading=!1,this.verificationCode="",this.showAppNotification(this.t("card.infoMessageWrongOtp"),"error"),l.error("[SoraCard]: Auth",t)})),this.sendOtpBtnLoading=!0}sendSms(){"0"===this.phoneNumber[0]&&(this.phoneNumber=this.phoneNumber.slice(1)),this.authLogin.PayWingsSendOtp(`${this.selectedCountry?.dialCode}${this.phoneNumber}`,"Your verification code is: @Otp").catch((t=>{l.error("[SoraCard]: Auth",t)})),this.startSmsCountDown()}openSelectCountryDialog(){this.showSelectCountryDialog=!0}handleSelectCountry(t){this.selectedCountry=t}get buttonDisabled(){return 6!==this.verificationCode.length}get otpInputDisabled(){return!this.smsSent||!this.isPhoneNumberValid}get buttonText(){return 6!==this.verificationCode.length?this.t("card.enterCodeBtn"):this.t("card.confirmCodeBtn")}set buttonText(t){this.buttonText=t}get sendSmsButtonText(){return this.smsSent?this.t("card.resendInBtn",{value:this.smsCountDown}):this.t("card.sendCodeBtn")}get isPhoneNumberValid(){const t=this.selectedCountry?.dialCode;return!!(t&&this.phoneNumber&&`${t}${this.phoneNumber}`.length>=8)}get sendSmsDisabled(){return!this.isPhoneNumberValid||this.smsSent}get phoneInputDisabled(){return this.smsSent}get phoneInputDescription(){return this.smsSent?this.t("card.phoneInputAfterSendDesc"):this.t("card.noSpamText")}startSmsCountDown(){const t=setInterval((()=>{this.smsResendCount--,this.smsResendCount<0&&(this.smsSent=!1,this.verificationCode="",this.smsResendCount=59,clearInterval(t))}),1e3)}async mounted(){await this.$nextTick(),localStorage.removeItem("PW-Email"),await this.initPayWingsAuthSdk(),this.authLogin&&this.authLogin.on("SendOtp-Success",(()=>{this.smsSent=!0,this.$nextTick((()=>{this.inputOtp.focus()}))})).on("MinimalRegistrationReq",(()=>{this.setReferenceNumber(null),this.sendOtpBtnLoading=!1,this.$emit("confirm",h.aS.Email),this.sendOtpBtnLoading=!1})).on("Otp-Verification-Success",(async()=>{if(await this.getUserStatus(),this.currentStatus===h.$Z.Rejected)return await this.getUserKycAttempt(),this.wantsToPassKycAgain&&this.hasFreeAttempts?(this.$emit("confirm",h.aS.Kyc),void this.setWillToPassKycAgain(!1)):void this.$emit("confirm",h.aS.KycResult);this.currentStatus===h.$Z.Accepted&&(await this.getUserIban(),this.userInfo.iban?this.$emit("confirm",h.aS.Dashboard):this.$emit("confirm",h.aS.KycResult)),this.currentStatus!==h.$Z.Pending?this.currentStatus||(this.isEuroBalanceEnough?this.$emit("confirm",h.aS.Kyc):this.$emit("confirm",h.aS.Payment)):this.$emit("confirm",h.aS.KycResult)})).on("Verification-Email-Sent-Success",(()=>{this.sendOtpBtnLoading=!1,this.$emit("confirm",h.aS.Email),this.sendOtpBtnLoading=!1}))}};(0,n.__decorate)([u.SB.soraCard.authLogin],p.prototype,"authLogin",void 0),(0,n.__decorate)([u.SB.soraCard.userInfo],p.prototype,"userInfo",void 0),(0,n.__decorate)([u.SB.soraCard.attemptCounter],p.prototype,"attemptCounter",void 0),(0,n.__decorate)([u.SB.soraCard.wantsToPassKycAgain],p.prototype,"wantsToPassKycAgain",void 0),(0,n.__decorate)([u.Yn.soraCard.currentStatus],p.prototype,"currentStatus",void 0),(0,n.__decorate)([u.Yn.soraCard.isEuroBalanceEnough],p.prototype,"isEuroBalanceEnough",void 0),(0,n.__decorate)([u.QF.soraCard.setWillToPassKycAgain],p.prototype,"setWillToPassKycAgain",void 0),(0,n.__decorate)([u.QF.soraCard.setReferenceNumber],p.prototype,"setReferenceNumber",void 0),(0,n.__decorate)([u.aD.soraCard.getUserStatus],p.prototype,"getUserStatus",void 0),(0,n.__decorate)([u.aD.soraCard.getUserIban],p.prototype,"getUserIban",void 0),(0,n.__decorate)([u.aD.soraCard.initPayWingsAuthSdk],p.prototype,"initPayWingsAuthSdk",void 0),(0,n.__decorate)([u.aD.soraCard.getUserKycAttempt],p.prototype,"getUserKycAttempt",void 0),(0,n.__decorate)([(0,o.Rl)("otp")],p.prototype,"inputOtp",void 0),(0,n.__decorate)([(0,o.RL)("smsResendCount",{immediate:!0})],p.prototype,"handleSmsCountChange",null),p=(0,n.__decorate)([(0,o.wA)({components:{SelectCountryDialog:(0,d.kF)(c.z8.SelectCountryDialog)}})],p);var m=p,g=(0,s(1001).Z)(m,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[e("p",{staticClass:"sora-card__number-input-desc"},[t._v(t._s(t.t("card.verificationCodeText")))]),e("s-button",{staticClass:"country-container",attrs:{autofocus:"",type:"tertiary",size:"big",disabled:t.phoneInputDisabled},on:{click:t.openSelectCountryDialog}},[e("span",{staticClass:"country-container__label s-flex"},[e("span",{staticClass:"country-container__text s-flex"},[t.selectedCountry?[e("span",{staticClass:"country-container__flag"},[t._v(t._s(t.selectedCountry.flag))]),e("span",[t._v(t._s(t.selectedCountry.translatedName))])]:[e("div",{staticClass:"country-container__flag country-container__flag--empty"}),e("span",[t._v(t._s(t.t("card.selectCountryText")))])]],2),e("s-icon",{staticClass:"country-container__icon",attrs:{name:"arrows-circle-chevron-bottom-24",size:"18"}})],1)]),e("div",{staticClass:"sora-card__number-input"},[e("div",{staticClass:"phone-container s-flex"},[e("s-input",{staticClass:"phone-code",attrs:{disabled:"",placeholder:t.t("card.code"),value:t.selectedCountry?.dialCode||""}}),e("s-input",{directives:[{name:"maska",rawName:"v-maska",value:"############",expression:"'############'"}],staticClass:"phone-number",attrs:{placeholder:t.t("card.phonePlaceholder"),disabled:t.phoneInputDisabled},model:{value:t.phoneNumber,callback:function(e){t.phoneNumber=e},expression:"phoneNumber"}})],1),e("s-button",{staticClass:"sora-card__send-sms-btn s-typography-button--large",attrs:{type:"secondary",disabled:t.sendSmsDisabled},on:{click:t.sendSms}},[t._v(" "+t._s(t.sendSmsButtonText)+" ")])],1),e("div",[e("p",{staticClass:"sora-card__number-input-desc"},[t._v(t._s(t.phoneInputDescription))]),t.smsSent?e("s-icon",{staticClass:"sora-card__icon",attrs:{name:"basic-check-mark-24",size:"14px"}}):t._e()],1),e("s-input",{directives:[{name:"maska",rawName:"v-maska",value:"######",expression:"'######'"}],ref:"otp",attrs:{placeholder:t.t("card.otpPlaceholder"),disabled:t.otpInputDisabled},model:{value:t.verificationCode,callback:function(e){t.verificationCode=e},expression:"verificationCode"}}),e("s-button",{staticClass:"sora-card__btn s-typography-button--large",attrs:{disabled:t.buttonDisabled,type:"primary",loading:t.sendOtpBtnLoading},on:{click:t.verifyCode}},[e("span",{staticClass:"text"},[t._v(" "+t._s(t.buttonText))])]),e("select-country-dialog",{attrs:{visible:t.showSelectCountryDialog},on:{"update:visible":function(e){t.showSelectCountryDialog=e},select:t.handleSelectCountry}})],1)}),[],!1,null,"1aa3d674",null).exports}}]);