"use strict";(self.webpackChunkpolkaswap_exchange_web=self.webpackChunkpolkaswap_exchange_web||[]).push([[5635],{35635:function(t,i,e){e.r(i),e.d(i,{default:function(){return _}});var o=e(23166),a=e(70655),s=e(22620),n=e(89445),l=e(81462),r=e(21329),p=e(68282),d=e(69781),g=e(49053),c=e(50961),h=e(2586),y=e(25108);let u=class extends((0,n.Wr)(h.Z)){constructor(...t){super(...t),(0,o.Z)(this,"widgetUrl",""),(0,o.Z)(this,"transactionsPolling",void 0),(0,o.Z)(this,"account",void 0),(0,o.Z)(this,"isLoggedIn",void 0),(0,o.Z)(this,"libraryTheme",void 0),(0,o.Z)(this,"transactions",void 0),(0,o.Z)(this,"pollingTimestamp",void 0),(0,o.Z)(this,"dialogVisibility",void 0),(0,o.Z)(this,"setDialogVisibility",void 0),(0,o.Z)(this,"createTransactionsPolling",void 0)}handleLoggedInStateChange(t){t||this.stopPollingMoonpay()}handleVisibleStateChange(t){t&&!this.pollingTimestamp&&this.startPollingMoonpay()}handleLanguageChange(){this.pollingTimestamp||this.updateWidgetUrl()}async handleLastTransaction(t,i){!t||i&&i.id===t.id||await this.prepareBridgeForTransfer(t)}get lastCompletedTransaction(){if(0!==this.pollingTimestamp)return this.transactions.find((t=>Date.parse(t.createdAt)>=this.pollingTimestamp&&"completed"===t.status))}get visibility(){return this.dialogVisibility}set visibility(t){this.setDialogVisibility(t)}async created(){this.withApi((()=>{this.initMoonpayApi(),this.updateWidgetUrl()}))}beforeDestroy(){this.stopPollingMoonpay()}createMoonpayWidgetUrl(){return this.moonpayApi.createWidgetUrl({colorCode:(0,c.y_)("--s-color-theme-accent"),externalTransactionId:this.account.address,language:this.language})}updateWidgetUrl(){this.widgetUrl="";const t=this.createMoonpayWidgetUrl();setTimeout((()=>{this.widgetUrl=t}))}async startPollingMoonpay(){y.info("Moonpay: start polling to get user transactions"),this.transactionsPolling=await this.createTransactionsPolling()}stopPollingMoonpay(){y.info("Moonpay: stop polling"),"function"==typeof this.transactionsPolling&&this.transactionsPolling()}async prepareBridgeForTransfer(t){this.setDialogVisibility(!1),this.stopPollingMoonpay(),this.updateWidgetUrl(),await this.showNotification(l.u.Success),await this.prepareMoonpayTxForBridgeTransfer(t,!0)}};(0,a.__decorate)([g.Yn.wallet.account.account],u.prototype,"account",void 0),(0,a.__decorate)([g.Yn.wallet.account.isLoggedIn],u.prototype,"isLoggedIn",void 0),(0,a.__decorate)([g.Yn.libraryTheme],u.prototype,"libraryTheme",void 0),(0,a.__decorate)([g.SB.moonpay.transactions],u.prototype,"transactions",void 0),(0,a.__decorate)([g.SB.moonpay.pollingTimestamp],u.prototype,"pollingTimestamp",void 0),(0,a.__decorate)([g.SB.moonpay.dialogVisibility],u.prototype,"dialogVisibility",void 0),(0,a.__decorate)([g.QF.moonpay.setDialogVisibility],u.prototype,"setDialogVisibility",void 0),(0,a.__decorate)([g.aD.moonpay.createTransactionsPolling],u.prototype,"createTransactionsPolling",void 0),(0,a.__decorate)([(0,n.RL)("isLoggedIn",{immediate:!0})],u.prototype,"handleLoggedInStateChange",null),(0,a.__decorate)([(0,n.RL)("visibility",{immediate:!0})],u.prototype,"handleVisibleStateChange",null),(0,a.__decorate)([(0,n.RL)("language"),(0,n.RL)("libraryTheme")],u.prototype,"handleLanguageChange",null),(0,a.__decorate)([(0,n.RL)("lastCompletedTransaction")],u.prototype,"handleLastTransaction",null),u=(0,a.__decorate)([(0,n.wA)({components:{DialogBase:s.wx.DialogBase,MoonpayLogo:r.default,IFrameWidget:(0,d.kF)(p.z8.IFrameWidget)}})],u);var m=u,_=(0,e(1001).Z)(m,(function(){var t=this,i=t._self._c;t._self._setupProxy;return i("dialog-base",{staticClass:"moonpay-dialog",attrs:{visible:t.visibility},on:{"update:visible":function(i){t.visibility=i}},scopedSlots:t._u([{key:"title",fn:function(){return[i("moonpay-logo",{attrs:{theme:t.libraryTheme}})]},proxy:!0}])},[i("i-frame-widget",{attrs:{src:t.widgetUrl}})],1)}),[],!1,null,null,null).exports}}]);